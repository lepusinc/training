# Lepus Inc. Technical Training

## 概要

株式会社レプスによる、バックエンドエンジニア向けソフトウェアテスト研修の資料です。

1. ソフトウェアテストの概要

2. テストコード演習

## ソフトウェアテストの概要

* ソフトウェアテストの目的
  1. ソフトウェア仕様を開発者に示す
  2. 破壊的変更 (Breaking change) からソフトウェアを保護する
  3. デグレードの心配なくリファクタリングを行える 

## インストール

### 要件

* PHP 8.1+

### Composer パッケージインストール

```
$ cd training/backend-test
$ composer install
```

### プログラム実行
```
$ php index.php
```

### テスト実行
```
$ vendor/phpunit/phpunit/phpunit tests
```

## テストコード演習

### 基本

1. 金額を受け取って、税込み金額を計算するメソッド `calculate` を実装する。初期仕様はテストコードを参照。（目的 1 に注目）
2. 実装できたら、`calculate` のテストが通ることを確認する。

### 練習：金額が1,000円未満の場合に税が免除される仕様が追加する

* 計算結果の小数点以下は切り捨てるものとする。

1. 改良仕様のテストケースを追加する。
2. `calculate` の実装を変更する。
3. テストがすべて通ることを確認する。

ポイント：最初のテストケースが通った状態を担保しつつ改良できている。（目的 2 に注目）

### 練習：税率を計算する部分を別のメソッド `getTaxRate` に分離する

1. `static function getTaxRate` メソッドを実装する。
2. テストが引き続き通ることを確認する。

ポイント：元の挙動を変更することなくリファクタリングできた。（目的 3 に注目）

### 練習：累進課税方式に対応する

* 金額が1,000円以上、1,000,000円未満：税率10%
* 金額が1,000,000円以上：税率15%
* 計算結果の小数点以下は切り捨てるものとする。

1. まずテストケースを追加して、テストが失敗する（RED）ことを確認する。
2. 仕様を満たすように `calculate` メソッドを実装する。
3. テストを再度実行して、テストが成功する（GREEN）ことを確認する。

---
(c) 2024 Lepus Inc.
